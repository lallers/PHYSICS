%/////////////////////////////////////////////////////////
% By: Lee Allers                                         /
%For: Physics Junior Lab, 2016                           /
%     University of New Mexico                           /
%/////////////////////////////////////////////////////////

clear all
clc
close all
%/////////////////////  Data //////////////////////////
p1.f = [0.931000000000000;1.67600000000000;2.42100000000000;3.91200000000000;6.33300000000000;10.0580000000000;15.8320000000000;25.1460000000000;39.8610000000000;63.1440000000000;100.024000000000;158.511000000000;251.271000000000;398.047000000000;630.878000000000;1000.05400000000;1584.92500000000;2511.96300000000;3981.03100000000;6309.52400000000;9999.98300000000;15848.8750000000;25118.8870000000]';
p1.a = [-0.123000000000000;-0.124000000000000;-0.123000000000000;-0.124000000000000;-0.127000000000000;-0.126000000000000;-0.131000000000000;-0.137000000000000;-0.149000000000000;-0.182000000000000;-0.251000000000000;-0.406000000000000;-0.752000000000000;-1.49700000000000;-2.93100000000000;-5.26200000000000;-8.51100000000000;-12.6070000000000;-17.6150000000000;-23.9030000000000;-31.6920000000000;-41.1550000000000;-50.8100000000000;]';
p1.p = [-0.0970000000000000;-0.155000000000000;-0.212000000000000;-0.441000000000000;-0.673000000000000;-1.03200000000000;-1.59700000000000;-2.54800000000000;-4.04500000000000;-6.37400000000000;-9.94900000000000;-15.5700000000000;-24.0170000000000;-35.9760000000000;-51.5600000000000;-69.6560000000000;-89.0460000000000;180+-109.592000000000;180+-132.925000000000;180+-158.283000000000;-5.622000000000;-30.186000000000;-50.129000000000]';

p2.t = {'0.000000';'100.000000';'200.000000';'300.000000';'400.000000';'500.000000';'600.000000';'700.000000';'800.000000';'900.000000';'1000.000000';'1100.000000';'1200.000000';'1300.000000';'1400.000000';'1500.000000';'1600.000000';'1700.000000';'1800.000000';'1900.000000';'2000.000000';'2100.000000';'2200.000000';'2300.000000';'2400.000000';'2500.000000';'2600.000000';'2700.000000';'2800.000000';'2900.000000';'3000.000000';'3100.000000';'3200.000000';'3300.000000';'3400.000000';'3500.000000';'3600.000000';'3700.000000';'3800.000000';'3900.000000';'4000.000000';'4100.000000';'4200.000000';'4300.000000';'4400.000000';'4500.000000';'4600.000000';'4700.000000';'4800.000000';'4900.000000';'5000.000000';'5100.000000';'5200.000000';'5300.000000';'5400.000000';'5500.000000';'5600.000000';'5700.000000';'5800.000000';'5900.000000';'6000.000000';'6100.000000';'6200.000000';'6300.000000';'6400.000000';'6500.000000';'6600.000000';'6700.000000';'6800.000000';'6900.000000';'7000.000000';'7100.000000';'7200.000000';'7300.000000';'7400.000000';'7500.000000';'7600.000000';'7700.000000';'7800.000000';'7900.000000';'8000.000000';'8100.000000';'8200.000000';'8300.000000';'8400.000000';'8500.000000';'8600.000000';'8700.000000';'8800.000000';'8900.000000';'9000.000000';'9100.000000';'9200.000000';'9300.000000';'9400.000000';'9500.000000';'9600.000000';'9700.000000';'9800.000000';'9900.000000';'10000.000000';'10100.000000';'10200.000000';'10300.000000';'10400.000000';'10500.000000';'10600.000000';'10700.000000';'10800.000000';'10900.000000';'11000.000000';'11100.000000';'11200.000000';'11300.000000';'11400.000000';'11500.000000';'11600.000000';'11700.000000';'11800.000000';'11900.000000';'12000.000000';'12100.000000';'12200.000000';'12300.000000';'12400.000000';'12500.000000';'12600.000000';'12700.000000';'12800.000000';'12900.000000';'13000.000000';'13100.000000';'13200.000000';'13300.000000';'13400.000000';'13500.000000';'13600.000000';'13700.000000';'13800.000000';'13900.000000';'14000.000000';'14100.000000';'14200.000000';'14300.000000';'14400.000000';'14500.000000';'14600.000000';'14700.000000';'14800.000000';'14900.000000';'15000.000000';'15100.000000';'15200.000000';'15300.000000';'15400.000000';'15500.000000';'15600.000000';'15700.000000';'15800.000000';'15900.000000';'16000.000000';'16100.000000';'16200.000000';'16300.000000';'16400.000000';'16500.000000';'16600.000000';'16700.000000';'16800.000000';'16900.000000';'17000.000000';'17100.000000';'17200.000000';'17300.000000';'17400.000000';'17500.000000';'17600.000000';'17700.000000';'17800.000000';'17900.000000';'18000.000000';'18100.000000';'18200.000000';'18300.000000';'18400.000000';'18500.000000';'18600.000000';'18700.000000';'18800.000000';'18900.000000';'19000.000000';'19100.000000';'19200.000000';'19300.000000';'19400.000000';'19500.000000';'19600.000000';'19700.000000';'19800.000000';'19900.000000';'20000.000000';'20100.000000';'20200.000000';'20300.000000';'20400.000000';'20500.000000';'20600.000000';'20700.000000';'20800.000000';'20900.000000';'21000.000000';'21100.000000';'21200.000000';'21300.000000';'21400.000000';'21500.000000';'21600.000000';'21700.000000';'21800.000000';'21900.000000';'22000.000000';'22100.000000';'22200.000000';'22300.000000';'22400.000000';'22500.000000';'22600.000000';'22700.000000';'22800.000000';'22900.000000';'23000.000000';'23100.000000';'23200.000000';'23300.000000';'23400.000000';'23500.000000';'23600.000000';'23700.000000';'23800.000000';'23900.000000';'24000.000000';'24100.000000';'24200.000000';'24300.000000';'24400.000000';'24500.000000';'24600.000000';'24700.000000';'24800.000000';'24900.000000';'25000.000000';'25100.000000';'25200.000000';'25300.000000';'25400.000000';'25500.000000';'25600.000000';'25700.000000';'25800.000000';'25900.000000';'26000.000000';'26100.000000';'26200.000000';'26300.000000';'26400.000000';'26500.000000';'26600.000000';'26700.000000';'26800.000000';'26900.000000';'27000.000000';'27100.000000';'27200.000000';'27300.000000';'27400.000000';'27500.000000';'27600.000000';'27700.000000';'27800.000000';'27900.000000';'28000.000000';'28100.000000';'28200.000000';'28300.000000';'28400.000000';'28500.000000';'28600.000000';'28700.000000';'28800.000000';'28900.000000';'29000.000000';'29100.000000';'29200.000000';'29300.000000';'29400.000000';'29500.000000';'29600.000000';'29700.000000';'29800.000000';'29900.000000';'30000.000000';'30100.000000';'30200.000000';'30300.000000';'30400.000000';'30500.000000';'30600.000000';'30700.000000';'30800.000000';'30900.000000';'31000.000000';'31100.000000';'31200.000000';'31300.000000';'31400.000000';'31500.000000';'31600.000000';'31700.000000';'31800.000000';'31900.000000';'32000.000000';'32100.000000';'32200.000000';'32300.000000';'32400.000000';'32500.000000';'32600.000000';'32700.000000';'32800.000000';'32900.000000';'33000.000000';'33100.000000';'33200.000000';'33300.000000';'33400.000000';'33500.000000';'33600.000000';'33700.000000';'33800.000000';'33900.000000';'34000.000000';'34100.000000';'34200.000000';'34300.000000';'34400.000000';'34500.000000';'34600.000000';'34700.000000';'34800.000000';'34900.000000';'35000.000000';'35100.000000';'35200.000000';'35300.000000';'35400.000000';'35500.000000';'35600.000000';'35700.000000';'35800.000000';'35900.000000';'36000.000000';'36100.000000';'36200.000000';'36300.000000';'36400.000000';'36500.000000';'36600.000000';'36700.000000';'36800.000000';'36900.000000';'37000.000000';'37100.000000';'37200.000000';'37300.000000';'37400.000000';'37500.000000';'37600.000000';'37700.000000';'37800.000000';'37900.000000';'38000.000000';'38100.000000';'38200.000000';'38300.000000';'38400.000000';'38500.000000';'38600.000000';'38700.000000';'38800.000000';'38900.000000';'39000.000000';'39100.000000';'39200.000000';'39300.000000';'39400.000000';'39500.000000';'39600.000000';'39700.000000';'39800.000000';'39900.000000'}';
p2.data = {-31.9699540000000;-53.2249000000000;-54.2518230000000;-51.6021510000000;-56.7634050000000;-54.6763300000000;-49.8303650000000;-55.2510310000000;-52.7667170000000;-52.8751040000000;-53.3775250000000;-54.4871430000000;-52.5737310000000;-53.3166060000000;-57.1480320000000;-55.0353600000000;-51.2404910000000;-53.1350410000000;-53.5322090000000;-54.8727050000000;-50.2544330000000;-53.1884480000000;-54.2544000000000;-53.4680750000000;-54.9156110000000;-54.1211790000000;-54.7474600000000;-54.7209000000000;-53.5645920000000;-55.1609440000000;-56.8296370000000;-52.2396100000000;-53.7230910000000;-53.8903550000000;-51.8492150000000;-52.5920850000000;-50.8370000000000;-50.9938910000000;-54.9776720000000;-54.7533740000000;-51.9526510000000;-51.4300080000000;-53.2493880000000;-51.6514050000000;-53.4958870000000;-51.7906900000000;-50.4837710000000;-49.5444760000000;-51.2871320000000;-49.4743560000000;-50.4210090000000;-52.6173800000000;-50.7043810000000;-48.7836160000000;-49.5347450000000;-48.6190800000000;-48.5905180000000;-48.7663170000000;-48.7449010000000;-48.9474440000000;-49.0605070000000;-46.9669380000000;-47.5470050000000;-46.3112880000000;-45.2344710000000;-44.6243000000000;-44.5943670000000;-43.1219040000000;-41.6542710000000;-41.9028220000000;-39.2345830000000;-38.4956740000000;-36.1227570000000;-33.5768490000000;-30.1158670000000;-23.6503660000000;-5.36711200000000;-25.5847270000000;-30.9765160000000;-34.3277260000000;-37.0183810000000;-39.0986750000000;-40.5557580000000;-41.9973310000000;-43.1826100000000;-44.2564750000000;-44.5492030000000;-44.8819920000000;-45.4348460000000;-47.9434280000000;-47.4100050000000;-48.4594860000000;-48.4655010000000;-48.2013150000000;-50.2537680000000;-49.4809210000000;-48.5744720000000;-50.6718440000000;-49.7616220000000;-51.8713230000000;-50.7787360000000;-52.0608530000000;-48.8108860000000;-54.4609070000000;-51.9247710000000;-52.4701210000000;-53.9380630000000;-51.7672480000000;-52.6077580000000;-51.1872440000000;-52.4647160000000;-52.2142170000000;-54.0104340000000;-53.8173740000000;-54.7810240000000;-52.4862350000000;-55.1943120000000;-50.8244300000000;-53.2202060000000;-54.2058550000000;-52.6599750000000;-54.9950590000000;-52.8537380000000;-53.1996410000000;-54.4430810000000;-54.4610630000000;-55.2186050000000;-56.2371910000000;-57.5183270000000;-53.0413370000000;-54.7878160000000;-53.8759570000000;-53.6747140000000;-56.2985210000000;-52.7711560000000;-54.0517770000000;-54.4131250000000;-54.1716200000000;-56.1159740000000;-53.6349110000000;-54.8965990000000;-54.2011020000000;-54.2899660000000;-54.2775290000000;-53.3375260000000;-49.7437420000000;-50.7079350000000;-54.7261760000000;-54.9455560000000;-57.6580310000000;-54.7404420000000;-53.0745300000000;-43.2121440000000;-53.1247570000000;-55.8972690000000;-53.1596590000000;-53.1356030000000;-53.6200340000000;-53.4284850000000;-55.9802260000000;-54.2789470000000;-55.7186010000000;-54.3172740000000;-52.8853950000000;-52.9629060000000;-59.2698630000000;-55.7401890000000;-54.5836460000000;-53.3974290000000;-56.8843510000000;-54.3578750000000;-57.4895160000000;-54.9152410000000;-53.6215360000000;-55.9117310000000;-57.2718040000000;-56.5186980000000;-57.3681560000000;-55.7896940000000;-55.7865670000000;-53.2763640000000;-55.9540610000000;-55.3132690000000;-55.1123570000000;-56.5948600000000;-57.9558530000000;-54.4372210000000;-53.6374560000000;-54.1398150000000;-55.5830900000000;-57.7665290000000;-54.3756770000000;-55.1070960000000;-50.6900920000000;-53.3324970000000;-57.0769080000000;-56.5966020000000;-54.0385270000000;-55.6925560000000;-51.9622600000000;-57.0726830000000;-54.8223150000000;-54.4018670000000;-55.4046170000000;-54.6110130000000;-55.3899580000000;-56.2565400000000;-54.1724120000000;-57.0389470000000;-56.6535960000000;-53.9580800000000;-56.2194720000000;-54.5165970000000;-57.9858970000000;-55.5559400000000;-55.9408530000000;-55.2673050000000;-55.7357670000000;-56.3154840000000;-57.1849470000000;-53.5587970000000;-54.1552730000000;-53.9589690000000;-54.8156410000000;-54.6495260000000;-54.4349470000000;-52.9316140000000;-50.5616200000000;-42.6528540000000;-52.5078310000000;-59.0705650000000;-54.6275210000000;-55.0128830000000;-54.9358570000000;-52.8395720000000;-55.7109080000000;-57.1570370000000;-55.2815820000000;-58.2002200000000;-57.8789090000000;-51.3321560000000;-54.3497500000000;-57.8477160000000;-56.2927910000000;-55.3722700000000;-56.8253720000000;-56.2236570000000;-54.7377680000000;-56.8439330000000;-56.7505670000000;-51.7520950000000;-54.5227650000000;-57.9151740000000;-55.5226870000000;-56.4053040000000;-53.9377370000000;-54.2537190000000;-54.9346720000000;-56.5114660000000;-55.6561230000000;-56.4100880000000;-56.1558430000000;-55.0713850000000;-54.2986660000000;-57.0726310000000;-55.3946880000000;-55.9155510000000;-53.5585150000000;-54.8640340000000;-48.4723250000000;-54.4298750000000;-54.2965360000000;-57.5356710000000;-54.4273980000000;-55.2332410000000;-50.5286000000000;-56.6442670000000;-54.7049090000000;-57.6406010000000;-59.8128760000000;-55.4026070000000;-53.1118320000000;-55.0992020000000;-56.2737220000000;-55.4413140000000;-56.5849140000000;-55.6108070000000;-52.9516540000000;-56.4235990000000;-56.5852490000000;-57.9886380000000;-53.0495490000000;-54.7408350000000;-55.0328190000000;-54.7456370000000;-54.8711740000000;-57.1468370000000;-54.9296640000000;-56.9643240000000;-55.0943450000000;-55.1133770000000;-54.0519690000000;-53.7037150000000;-49.8331960000000;-49.2333030000000;-55.9915500000000;-55.1228580000000;-55.8240830000000;-53.4783580000000;-54.6698600000000;-56.3776490000000;-59.0012660000000;-58.2333500000000;-55.1604590000000;-58.4023890000000;-56.9403490000000;-52.5628670000000;-53.5022820000000;-54.6832700000000;-57.4646010000000;-56.9342460000000;-54.4272740000000;-54.4356900000000;-55.8563760000000;-55.8857590000000;-57.7327490000000;-57.7446110000000;-55.1704260000000;-58.3638860000000;-53.3784750000000;-56.0839360000000;-55.5986520000000;-53.1083640000000;-53.7765350000000;-54.7084010000000;-56.1742810000000;-57.8279300000000;-54.5973390000000;-47.9503700000000;-52.1840790000000;-55.2957800000000;-54.8645110000000;-52.5504830000000;-56.3062360000000;-53.0296300000000;-53.4122580000000;-56.5621940000000;-55.7731170000000;-57.2471270000000;-55.3442330000000;-55.3877010000000;-46.7410090000000;-53.4082280000000;-55.4316550000000;-56.3104000000000;-54.5418630000000;-56.3544960000000;-53.7709820000000;-56.1528340000000;-54.8808390000000;-57.9864110000000;-57.1624470000000;-53.3620150000000;-56.8588910000000;-55.4313800000000;-56.8755260000000;-54.4631580000000;-53.6572680000000;-55.9844940000000;-57.6500950000000;-56.4603400000000;-56.7840390000000;-53.9446670000000;-49.9382040000000;-54.7153600000000;-56.2956290000000;-55.3597780000000;-55.9492010000000;-55.7451950000000;-52.1088310000000;-52.4252710000000;-54.4470650000000;-55.8145010000000;-55.3236260000000;-55.5505600000000;-58.4949100000000;-57.2495390000000;-59.0762430000000;-56.7769110000000;-53.5406770000000;-55.9998710000000;-55.5675350000000;-55.1118980000000;-54.6229230000000;-56.5413090000000;-56.6954510000000;-56.7312340000000;-58.6688630000000;-55.8578890000000;-56.9909290000000}';
p2.t = str2double(p2.t);
p2.data = cell2mat(p2.data);

p3.f = [100.024000000000;158.511000000000;251.271000000000;398.047000000000;630.878000000000;1000.05400000000;1584.92500000000;2511.96300000000;3981.03100000000;6309.52400000000;9999.98300000000;15848.8750000000;25118.8870000000;39810.6870000000;63095.8010000000;100000.016000000]'*10^(-.5);
p3.a = [-0.0110000000000000;-0.0300000000000000;-0.0780000000000000;-0.163000000000000;-0.364000000000000;-0.812000000000000;-1.81300000000000;-3.82000000000000;-7.31500000000000;-12.4530000000000;-18.8240000000000;-26.0030000000000;-33.5950000000000;-41.3080000000000;-49.0830000000000;-60.3570000000000]';
p3.p = [-3.41600000000000;-5.37400000000000;-8.55300000000000;-13.3370000000000;-20.8420000000000;-32.2530000000000;-48.7820000000000;-70.6740000000000;-95.6640000000000;75.905000000000;55.270000000000;30.817000000000;0.946000000000;-25.499000000000;-48.306000000000;-70.171000000000;]';

p4.t = {'0.000000';'37.503750';'75.007501';'112.511251';'150.015002';'187.518752';'225.022502';'262.526253';'300.030003';'337.533753';'375.037504';'412.541254';'450.045005';'487.548755';'525.052505';'562.556256';'600.060006';'637.563756';'675.067507';'712.571257';'750.075008';'787.578758';'825.082508';'862.586259';'900.090009';'937.593759';'975.097510';'1012.601260';'1050.105011';'1087.608761';'1125.112511';'1162.616262';'1200.120012';'1237.623762';'1275.127513';'1312.631263';'1350.135014';'1387.638764';'1425.142514';'1462.646265';'1500.150015';'1537.653765';'1575.157516';'1612.661266';'1650.165017';'1687.668767';'1725.172517';'1762.676268';'1800.180018';'1837.683768';'1875.187519';'1912.691269';'1950.195020';'1987.698770';'2025.202520';'2062.706271';'2100.210021';'2137.713771';'2175.217522';'2212.721272';'2250.225023';'2287.728773';'2325.232523';'2362.736274';'2400.240024';'2437.743774';'2475.247525';'2512.751275';'2550.255026';'2587.758776';'2625.262526';'2662.766277';'2700.270027';'2737.773777';'2775.277528';'2812.781278';'2850.285029';'2887.788779';'2925.292529';'2962.796280';'3000.300030';'3037.803780';'3075.307531';'3112.811281';'3150.315032';'3187.818782';'3225.322532';'3262.826283';'3300.330033';'3337.833783';'3375.337534';'3412.841284';'3450.345035';'3487.848785';'3525.352535';'3562.856286';'3600.360036';'3637.863786';'3675.367537';'3712.871287';'3750.375038';'3787.878788';'3825.382538';'3862.886289';'3900.390039';'3937.893789';'3975.397540';'4012.901290';'4050.405041';'4087.908791';'4125.412541';'4162.916292';'4200.420042';'4237.923792';'4275.427543';'4312.931293';'4350.435044';'4387.938794';'4425.442544';'4462.946295';'4500.450045';'4537.953795';'4575.457546';'4612.961296';'4650.465047';'4687.968797';'4725.472547';'4762.976298';'4800.480048';'4837.983798';'4875.487549';'4912.991299';'4950.495050';'4987.998800';'5025.502550';'5063.006301';'5100.510051';'5138.013801';'5175.517552';'5213.021302';'5250.525053';'5288.028803';'5325.532553';'5363.036304';'5400.540054';'5438.043804';'5475.547555';'5513.051305';'5550.555056';'5588.058806';'5625.562556';'5663.066307';'5700.570057';'5738.073807';'5775.577558';'5813.081308';'5850.585059';'5888.088809';'5925.592559';'5963.096310';'6000.600060';'6038.103810';'6075.607561';'6113.111311';'6150.615062';'6188.118812';'6225.622562';'6263.126313';'6300.630063';'6338.133813';'6375.637564';'6413.141314';'6450.645065';'6488.148815';'6525.652565';'6563.156316';'6600.660066';'6638.163816';'6675.667567';'6713.171317';'6750.675068';'6788.178818';'6825.682568';'6863.186319';'6900.690069';'6938.193819';'6975.697570';'7013.201320';'7050.705071';'7088.208821';'7125.712571';'7163.216322';'7200.720072';'7238.223822';'7275.727573';'7313.231323';'7350.735074';'7388.238824';'7425.742574';'7463.246325';'7500.750075';'7538.253825';'7575.757576';'7613.261326';'7650.765077';'7688.268827';'7725.772577';'7763.276328';'7800.780078';'7838.283828';'7875.787579';'7913.291329';'7950.795080';'7988.298830';'8025.802580';'8063.306331';'8100.810081';'8138.313831';'8175.817582';'8213.321332';'8250.825083';'8288.328833';'8325.832583';'8363.336334';'8400.840084';'8438.343834';'8475.847585';'8513.351335';'8550.855086';'8588.358836';'8625.862586';'8663.366337';'8700.870087';'8738.373837';'8775.877588';'8813.381338';'8850.885089';'8888.388839';'8925.892589';'8963.396340';'9000.900090';'9038.403840';'9075.907591';'9113.411341';'9150.915092';'9188.418842';'9225.922592';'9263.426343';'9300.930093';'9338.433843';'9375.937594';'9413.441344';'9450.945095';'9488.448845';'9525.952595';'9563.456346';'9600.960096';'9638.463846';'9675.967597';'9713.471347';'9750.975098';'9788.478848';'9825.982598';'9863.486349';'9900.990099';'9938.493849';'9975.997600';'10013.501350';'10051.005101';'10088.508851';'10126.012601';'10163.516352';'10201.020102';'10238.523852';'10276.027603';'10313.531353';'10351.035104';'10388.538854';'10426.042604';'10463.546355';'10501.050105';'10538.553855';'10576.057606';'10613.561356';'10651.065107';'10688.568857';'10726.072607';'10763.576358';'10801.080108';'10838.583858';'10876.087609';'10913.591359';'10951.095110';'10988.598860';'11026.102610';'11063.606361';'11101.110111';'11138.613861';'11176.117612';'11213.621362';'11251.125113';'11288.628863';'11326.132613';'11363.636364';'11401.140114';'11438.643864';'11476.147615';'11513.651365';'11551.155116';'11588.658866';'11626.162616';'11663.666367';'11701.170117';'11738.673867';'11776.177618';'11813.681368';'11851.185119';'11888.688869';'11926.192619';'11963.696370';'12001.200120';'12038.703870';'12076.207621';'12113.711371';'12151.215122';'12188.718872';'12226.222622';'12263.726373';'12301.230123';'12338.733873';'12376.237624';'12413.741374';'12451.245125';'12488.748875';'12526.252625';'12563.756376';'12601.260126';'12638.763876';'12676.267627';'12713.771377';'12751.275128';'12788.778878';'12826.282628';'12863.786379';'12901.290129';'12938.793879';'12976.297630';'13013.801380';'13051.305131';'13088.808881';'13126.312631';'13163.816382';'13201.320132';'13238.823882';'13276.327633';'13313.831383';'13351.335134';'13388.838884';'13426.342634';'13463.846385';'13501.350135';'13538.853885';'13576.357636';'13613.861386';'13651.365137';'13688.868887';'13726.372637';'13763.876388';'13801.380138';'13838.883888';'13876.387639';'13913.891389';'13951.395140';'13988.898890';'14026.402640';'14063.906391';'14101.410141';'14138.913891';'14176.417642';'14213.921392';'14251.425143';'14288.928893';'14326.432643';'14363.936394';'14401.440144';'14438.943894';'14476.447645';'14513.951395';'14551.455146';'14588.958896';'14626.462646';'14663.966397';'14701.470147';'14738.973897';'14776.477648';'14813.981398';'14851.485149';'14888.988899';'14926.492649';'14963.996400'}';
p4.data = {-24.5776840000000;-55.9494760000000;-57.9189000000000;-56.4024710000000;-53.4527950000000;-54.8158240000000;-56.4065870000000;-55.0364860000000;-54.1557120000000;-56.4168880000000;-56.2092040000000;-55.7139780000000;-57.8340530000000;-59.3817840000000;-54.5259030000000;-56.1344250000000;-56.5905340000000;-54.4508870000000;-54.5675640000000;-56.6580650000000;-54.2063970000000;-56.9434370000000;-56.2228630000000;-59.5259300000000;-57.7970150000000;-54.9586980000000;-55.7240580000000;-57.2977000000000;-57.7144960000000;-54.7633850000000;-56.4199390000000;-56.9130160000000;-56.6452430000000;-55.6702360000000;-56.6879170000000;-54.6284760000000;-56.5738230000000;-57.6205000000000;-56.0159330000000;-56.1941340000000;-54.6275190000000;-57.9547030000000;-57.2349630000000;-54.6486880000000;-54.0585720000000;-54.6063800000000;-56.3085810000000;-55.6850040000000;-56.0541640000000;-55.9008060000000;-57.9895200000000;-55.8391750000000;-53.5664320000000;-57.2625790000000;-52.3490430000000;-47.1879930000000;-52.1230000000000;-52.6250380000000;-54.6207240000000;-50.9696130000000;-53.1238790000000;-52.6930950000000;-46.6659150000000;-42.0820960000000;-53.3166530000000;-54.7898590000000;-51.8925680000000;-53.1615520000000;-55.2061230000000;-53.9014470000000;-51.7457470000000;-52.9442220000000;-56.6878780000000;-55.6247070000000;-54.6915560000000;-55.8558680000000;-57.0616080000000;-55.0106300000000;-57.8348140000000;-56.8167440000000;-58.0500950000000;-54.1414470000000;-55.3713320000000;-54.5578960000000;-56.3732380000000;-56.4486620000000;-54.9576810000000;-54.5981660000000;-54.8133530000000;-57.2991380000000;-56.2039690000000;-55.4374570000000;-55.9779590000000;-57.1795890000000;-56.7001630000000;-56.4794920000000;-56.2720200000000;-56.7386460000000;-54.1965830000000;-55.7663480000000;-55.7333980000000;-52.9381080000000;-54.7447200000000;-55.3152350000000;-54.4046650000000;-53.9857980000000;-56.0686490000000;-54.7026210000000;-55.2451750000000;-58.3011540000000;-52.7956980000000;-52.6797750000000;-54.2673360000000;-53.9526580000000;-52.1629390000000;-53.7411500000000;-53.6776920000000;-53.6051960000000;-50.1795670000000;-51.7589890000000;-50.8476810000000;-49.3548540000000;-48.0133250000000;-53.0957020000000;-53.5835630000000;-46.5261700000000;-52.8898700000000;-54.9004300000000;-53.9912620000000;-55.2806790000000;-55.4092340000000;-52.6964490000000;-53.6640280000000;-54.2762650000000;-53.8906380000000;-52.4740760000000;-55.4446230000000;-53.8275760000000;-53.4329790000000;-53.9600620000000;-51.2180400000000;-51.4368400000000;-51.5619610000000;-51.5235140000000;-50.9569070000000;-51.8603450000000;-53.0519300000000;-52.2440070000000;-52.5416730000000;-50.9674680000000;-49.8671790000000;-50.8082350000000;-53.0645640000000;-50.6054910000000;-52.1502480000000;-50.3957340000000;-49.2582330000000;-48.0924720000000;-49.7046820000000;-49.7297830000000;-50.1839970000000;-49.2696420000000;-47.7328760000000;-46.9311690000000;-46.9663920000000;-46.6012200000000;-47.6867920000000;-45.8861240000000;-46.4824300000000;-44.9127800000000;-44.5662580000000;-44.2648820000000;-43.6219980000000;-42.3871450000000;-42.3735660000000;-41.4881300000000;-39.9167690000000;-38.1107250000000;-37.7556420000000;-35.9129800000000;-34.5539150000000;-32.3908880000000;-29.0900230000000;-24.1611340000000;-12.1859900000000;-18.0757120000000;-26.2147570000000;-30.2844610000000;-32.6914420000000;-34.9559400000000;-36.5751690000000;-38.5659360000000;-39.4285160000000;-40.6422770000000;-41.7184630000000;-41.9919600000000;-42.6676010000000;-42.9075390000000;-44.4566150000000;-44.3090730000000;-44.6010950000000;-46.1188690000000;-46.2019700000000;-47.1194530000000;-47.0631230000000;-47.0336190000000;-46.8099620000000;-49.6312850000000;-49.1638800000000;-49.3884130000000;-48.6748690000000;-49.5392210000000;-50.2253220000000;-49.3775630000000;-51.2714600000000;-50.7458120000000;-50.7588730000000;-51.4251520000000;-48.9103150000000;-49.6444730000000;-50.5009300000000;-52.0515220000000;-51.5239640000000;-53.0952280000000;-53.1478980000000;-53.7354400000000;-52.8523620000000;-53.4072100000000;-53.8010700000000;-51.6656630000000;-52.3153380000000;-52.6223580000000;-53.3504890000000;-53.7117400000000;-52.1537640000000;-53.2555000000000;-52.2975740000000;-51.2557500000000;-53.7031050000000;-52.6802880000000;-52.9279770000000;-53.8425500000000;-54.1607590000000;-50.6903180000000;-52.7083870000000;-53.5295140000000;-49.5545680000000;-33.2658540000000;-52.6836580000000;-53.2816240000000;-53.3023870000000;-51.5800290000000;-52.1344120000000;-54.5070360000000;-53.1067960000000;-52.3172960000000;-53.9348990000000;-55.3622080000000;-54.4194330000000;-52.8839490000000;-56.2969390000000;-52.4898840000000;-54.5670700000000;-55.7044270000000;-56.4165580000000;-54.3665610000000;-54.8938250000000;-56.2533260000000;-54.3345770000000;-56.6729080000000;-53.1428160000000;-57.0385530000000;-56.5318200000000;-54.8956590000000;-56.2812640000000;-56.4497970000000;-53.5701680000000;-56.4619020000000;-56.5892570000000;-57.3761580000000;-55.6084460000000;-55.5552240000000;-55.3241120000000;-56.5695860000000;-55.3938790000000;-54.2952090000000;-52.8362330000000;-55.2274220000000;-54.1821320000000;-56.8677350000000;-56.6787350000000;-57.7394170000000;-55.8768760000000;-56.0903240000000;-55.3716210000000;-55.5546930000000;-55.7411240000000;-54.8532860000000;-55.2396860000000;-54.2112790000000;-56.2116490000000;-56.5120190000000;-49.8175770000000;-54.0218160000000;-57.0627130000000;-53.7120410000000;-44.6842400000000;-55.2372380000000;-55.3839080000000;-52.8885750000000;-49.1995520000000;-55.4460590000000;-54.3156130000000;-55.9007620000000;-53.0993770000000;-54.4448550000000;-55.9236950000000;-52.4760020000000;-57.1588360000000;-56.7016500000000;-57.1873520000000;-56.9414460000000;-55.5467420000000;-55.3601770000000;-58.5652770000000;-55.4792740000000;-56.0963930000000;-56.1389550000000;-55.0992010000000;-54.6004380000000;-55.9916940000000;-56.1762450000000;-58.9771670000000;-55.5552750000000;-54.4544280000000;-56.7303470000000;-57.8920280000000;-55.2499690000000;-56.4090370000000;-55.6061790000000;-56.9818130000000;-55.6747140000000;-59.0403630000000;-55.5436050000000;-56.2548030000000;-55.3992760000000;-55.1477190000000;-57.8782440000000;-55.9239460000000;-57.2280380000000;-55.7253400000000;-56.1496420000000;-53.4013850000000;-53.0241310000000;-54.4610450000000;-54.7287600000000;-57.8225870000000;-54.3233570000000;-54.1575940000000;-53.5282650000000;-53.2563480000000;-52.4077250000000;-56.2740170000000;-55.1901460000000;-54.9858120000000;-49.3335480000000;-48.7692690000000;-44.7129360000000;-37.5966450000000;-31.3884850000000;-43.3444220000000;-49.0992230000000;-49.8785490000000;-51.3394570000000;-52.5346990000000;-52.8283580000000;-52.6630560000000;-54.4880290000000;-55.2354620000000;-52.7321260000000;-54.9931810000000;-55.4680380000000;-52.5502200000000;-54.8621140000000;-57.1464370000000;-52.9449080000000;-55.4284350000000;-55.2587250000000;-54.6482610000000;-57.1621110000000;-56.9218820000000;-56.5273490000000;-54.8005040000000;-54.5834220000000;-57.6581480000000;-58.2481900000000;-56.7224300000000;-56.5625540000000;-54.1001320000000;-53.1688070000000}';
p4.t = str2double(p4.t);
p4.data = cell2mat(p4.data);
%/////////////////////  Data //////////////////////////

R1 = 4.7 * 1000; 
R2 = 4.7 * 1000; 
R3 = 4.7 * 1000; 
C1 = 10e-9 ;
C2 = 10e-9 ;
C3 = 10e-9 ;

%Circuit 2 Specific

R2a = 100 * 1000; 
R2b = 3.3e6;

%Circuit 4 Specific
R4a = 100 * 1000;
R4b = 1e6;

%++++++++++++++++++++++ Initialize ++++++++++++++++++++
F.f =logspace(0,5,10000);
F.w = 2*pi*F.f;
F.Phase =@(G) rad2deg(atan(imag(G)./real(G)));
F.Amp =@(G) 20.*log10(abs(G));
F.Zc = @(C) 1./(1j.*F.w.*C); 


%////////////////////////  Circuit1 Phase Shift Oscillator  //////////////////
Circuit1.VoutV2 = F.Zc(C3)./(R3 + F.Zc(C3));
Circuit1.Z2 = 1./((1./F.Zc(C2) + 1./(R3 + F.Zc(C3))));
Circuit1.Z1 = 1./((1./F.Zc(C1) + 1./(R2 + Circuit1.Z2)));
Circuit1.V2V1 = Circuit1.Z2 ./ (R2 + Circuit1.Z2);
Circuit1.V1Vin = Circuit1.Z1 ./ (R1 + Circuit1.Z1);
Circuit1.G = Circuit1.VoutV2 .* Circuit1.V2V1 .* Circuit1.V1Vin;
Circuit1.Amp = F.Amp(Circuit1.G);
Circuit1.Phase = F.Phase(Circuit1.G);


figure('units','normalized','position',[.1 .1 .4 .8])

subplot(2,1,1)
semilogx(F.f,Circuit1.Amp); hold on
scatter(p1.f,p1.a)
title('Pase-Shift Oscillator Amplitude');xlabel('Frequency (Hz)');ylabel('Amplitude');
h = legend('Theory','Data'); set(h,'Location','southwest') 
hold off

subplot(2,1,2)
semilogx(F.f,Circuit1.Phase); hold on
scatter(p1.f,p1.p)
title('Pase-Shift Oscillator - Phase');xlabel('Frequency (Hz)');ylabel('Phase (\phi)');
h = legend('Theory','Data'); set(h,'Location','southwest')
hold off



%//////////////////////////////////////////////////////////



%////////////////////////  Circuit2      //////////////////

Circuit2.G =  (1./(1 + R1 .* F.Zc(C1))).^3;
Circuit2.Amp = F.Amp(Circuit1.G);
Circuit2.Phase = F.Phase(Circuit1.G);


figure('units','normalized','position',[.1 .1 .4 .8])

subplot(2,1,1)
semilogx(F.f,Circuit2.Amp); hold on
scatter(p3.f,p3.a)
title('Buffered Phase-shift Oscillator - Amplitude');xlabel('Frequency (Hz)');ylabel('Amplitude');
h = legend('Theory','Data');
hold off

subplot(2,1,2)
semilogx(F.f,Circuit2.Phase); hold on
scatter(p3.f,(p3.p))
title('Buffered Phase-shift Oscillator - Phase');xlabel('Frequency (Hz)');ylabel('Phase (\phi)');
h = legend('Theory','Data');
hold off


%//////////////////////////////////////////////////////////


%%///////////////////////    DSA SPECTRUM Analyzer ///////////////////////////////////
DSA.Peak1Theory  = 8500; %Hz
DSA.Peak2Theory = 6000; %Hz


DSA.Peak1DataA   = max(p2.data);
[~,col] = max(p2.data);
DSA.Peak1DataF   = p2.t(:,col);


DSA.Peak2DataA   = max(p4.data);
[~,col] = max(p4.data);
DSA.Peak2DataF   = p4.t(:,col);

build1a = sprintf('Actual Peak @ %g kHz ',DSA.Peak1DataF);
build1b = sprintf('Expected Peak @ %g kHz',DSA.Peak1Theory);
build2a = sprintf('Expected Peak @ %g kHz',DSA.Peak2Theory);
build2b = sprintf('Actual Peak @ %g kHz' ,DSA.Peak2DataF);
build1 = sprintf('%s \n%s',build1a,build1b);

figure('units','normalized','position',[.1 .1 .4 .8])

sz = 15;
c = linspace(0,10,length(p2.t));

C = subplot(2,1,1);
plot(p2.t,p2.data,'b');hold on
scatter(p2.t,p2.data,sz,c,'filled','d');
B = scatter(DSA.Peak1Theory, DSA.Peak1DataA,'m');
A = scatter(DSA.Peak1DataF, DSA.Peak1DataA,'r');
legend([B,A],build1b,build1a)
colormap(gca, flipud(summer(256)));
colorbar;
title('DSA Spectra PS Oscillator');xlabel('Frequency (Hz)');ylabel('Amplitude (db*Vrms)');
hold off

c = linspace(0,10,length(p4.t));
C =subplot(2,1,2);
plot(p4.t,p4.data,'r');hold on
scatter(p4.t,p4.data,sz,c,'filled');
B = scatter(DSA.Peak2Theory, DSA.Peak2DataA,'m');
A = scatter(DSA.Peak2DataF, DSA.Peak2DataA,'r');
legend([B,A],build2a,build2b)
title('DSA Spectra Buffered PS Oscillator');xlabel('Frequency (Hz)');ylabel('Amplitude (db*Vrms)');
colormap(C,spring)
hold off
%//////////////////////////////////////////////////////////
